# Тестовое задание

## Описание проекта

### Этот проект состоит из трех сервисов:

1. user-service: Сервис для управления пользователями.
2. action-history-service: Сервис для ведения истории действий с пользователями.
3. user-service-n-migration: Сервис для массового управления флагом проблем у пользователей.

### Структура проекта

- user-service: Сервис пользователей на TypeScript с использованием NestJS.
- action-history-service: Сервис истории действий на JavaScript с использованием NestJS.
- user-service-n-migration: Сервис для массового управления пользователями на TypeScript с использованием NestJS.

## Задание 1

Необходимо реализовать два сервиса: сервис пользователей и сервис истории действий с пользователями.

### user-service

Этот сервис предоставляет три эндпоинта для работы с пользователями:

1. Создание пользователя
2. Изменение пользователя
3. Получение списка пользователей

### action-history-service

Этот сервис отвечает за регистрацию событий создания и изменения пользователей. Также предоставляет эндпоинт для получения истории действий с фильтрами по id пользователя и постраничной навигацией.

## Задание 2

Необходимо написать сервис, который работает с пользователями. В базе данных может быть более 1 миллиона пользователей. Каждый пользователь имеет следующие поля:

- Имя
- Фамилия
- Возраст
- Пол
- Проблемы: boolean (есть ли проблемы у пользователя)

## user-service-n-migration

Этот сервис предоставляет эндпоинт, который проставляет флаг проблем у всех пользователей в false и подсчитывает количество пользователей, у которых был установлен флаг true.

Технологии

- Node.js: Для выполнения JavaScript и TypeScript кода.
- NestJS: Для создания модульных и тестируемых серверных приложений.
- TypeORM: ORM для работы с базой данных PostgreSQL.
- PostgreSQL: В качестве базы данных.

Установка и запуск

1. Клонируйте репозиторий:
    ```bash
    git clone <repository_url>
    cd <repository_directory>
    ```
2. Установите зависимости для каждого сервиса:
    ```bash
   cd user-service
   npm install
   cd ../action-history-service
   npm install
   cd ../user-service-n-migration
   npm install
   ```

3. Настройте базы данных в каждом сервисе. Создайте файл .env в корневом каталоге каждого сервиса и заполните его необходимыми параметрами подключения к PostgreSQL.

4. Запустите миграции для создания и заполнения таблиц:
   ```bash
   cd user-service
   npx typeorm migration:run
   cd ../action-history-service
   npx typeorm migration:run
   cd ../user-service-n-migration
   npx typeorm migration:run
   ```

5. Запустите каждый сервис:
   ```bash
   cd user-service
   npm start
   cd ../action-history-service
   npm start
   cd ../user-service-n-migration
   npm start
   ```

## API

### user-service

- POST /users: Создание пользователя
- PUT /users/:id: Изменение пользователя
- GET /users: Получение списка пользователей

### action-history-service

- GET /actions: Получение истории действий с фильтрами по id пользователя и постраничной навигацией

### user-service-n-migration

- POST /users/update-problems: Проставить флаг проблем у всех пользователей в false и подсчитать количество пользователей с флагом true
